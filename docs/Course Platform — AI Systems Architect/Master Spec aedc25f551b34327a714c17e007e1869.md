# Master Spec

<aside>
✅

**Status:** Confirmed — 23 Dec 2025 (Updated with Growth Spec changes)

</aside>

## 1. Product Overview

- **Vision:** A self-hosted course delivery platform for AI Systems Architect — own the stack, own the credibility.
- **Target User:**
    - Solo builders (founders, indie hackers, PM-engineers)
    - Experienced devs learning AI-first workflows
    - Tech teams adopting AI tools
- **Core Value:** A structured system that turns learners into builders — not just more content, but a repeatable methodology.

---

## 2. Phase 1 — MVP Features

### 2.1 Authentication & Onboarding

**Purpose:** Get users signed up and capture context for personalisation.

### User-Facing Features

- **Sign up / Log in:** Email + password (or OAuth — Google)
- **Guided onboarding flow:**
    - Name
    - "What best describes you?" (Solo builder / Experienced dev / Tech team)
    - "What do you want to build?" (freeform or dropdown)
    - "How experienced are you with AI tools?" (Beginner / Intermediate / Advanced)
- **Redirect to course dashboard** after onboarding complete

### Admin Features

- View onboarding data in user records

### Edge Cases

- **Incomplete onboarding:** User can skip but gets reminded on next login
- **OAuth failures:** Fallback to email/password with clear error message

---

### 2.2 Subscription & Payments

**Purpose:** Gate content behind a subscription paywall after Video 1.

### Pricing

| Plan | Price | Value Prop |
| --- | --- | --- |
| Monthly | £49/month | Flexibility, cancel anytime |
| Annual | £399/year | 2 months free (~£33/month) |

### User-Facing Features

- **Free access:** Video 1 (founder intro) only
- **Subscription plans:** Monthly (£49) or Annual (£399) — Stripe Checkout
- **Paywall placement:** After Video 1 completion, before rest of course
- **90-day money-back guarantee:** Full refund if not satisfied
- **In-app billing page:**
    - Current plan & status
    - Next billing date
    - Invoice history
    - Update payment method
    - Cancel subscription
- **Upgrade prompts:** After Video 1 completion

### Admin Features

- View user subscription status
- Manually grant/revoke access (override)

### Edge Cases

- **Failed payment:** Immediate soft lock — user sees course structure but content is locked, banner prompts payment update
- **Subscription cancelled:** Access continues until period end, then soft lock
- **Refund requested:** Process within 90 days per guarantee

---

### 2.3 Course Structure & Content

**Purpose:** Deliver hybrid content (video, text, downloadables) in a structured format.

### User-Facing Features

- **Course dashboard:** Overview of all modules with progress indicators
- **Module view:** List of lessons within module, completion status per lesson
- **Lesson view:**
    - Video player (Mux)
    - Text/rich content below video
    - Inline downloadable assets (prompts, templates)
    - "Mark as complete" button
- **Module gating:** Must complete all lessons in Module N to unlock Module N+1
- **Video 1 = Free:** Founder intro available to all users after onboarding

### Content Types Supported

- Video (Mux hosted)
- Rich text (markdown/HTML)
- Downloadable files (PDF, MD, etc.)

### Admin Features

- **Basic CMS:**
    - CRUD for Modules (title, description, order)
    - CRUD for Lessons (title, video URL, rich text content, order)
    - CRUD for Assets (file upload, attach to lesson)
    - Drag-drop reordering
    - Preview lesson before publish

### Edge Cases

- **Video playback failure:** Generic error — "Video unavailable, please try again"
- **Missing asset:** Graceful fallback — hide download button, log error

---

### 2.4 Progress Tracking

**Purpose:** Track user progress and create engagement through celebration moments.

### User-Facing Features

- **Lesson completion:** Binary — complete or not complete
- **Module progress:** X of Y lessons complete
- **Course progress:** X of Y modules complete (shown on dashboard)
- **Resume where you left off:** Dashboard highlights next incomplete lesson
- **Celebration moments:**
    - Confetti/animation on module completion
    - "Share your progress" prompt (Twitter/LinkedIn)
    - "You've completed X!" milestone messages
    - Dramatic "unlock" animation for next module

### Data Captured

- Lesson ID + User ID + completed_at timestamp
- Module completion timestamps
- No partial video progress tracking (MVP)

### Admin Features

- View user progress (read-only)

---

### 2.5 Email Sequences

**Purpose:** Drive engagement, retention, and recover abandonment.

### Automated Emails

| Trigger | Email | Timing |
| --- | --- | --- |
| Signup | Welcome + next steps | Immediately |
| No Video 1 start | "Start your journey" | 24 hours after signup |
| Video 1 complete, no subscribe | Abandonment email 1 | 1 hour |
| Video 1 complete, no subscribe | Abandonment email 2 | 24 hours |
| Video 1 complete, no subscribe | Abandonment email 3 | 3 days |
| Module completed | Congratulations + what's next | On completion |
| Inactive | "You haven't logged in" | 7 days since last activity |
| Renewal coming | Reminder | 3 days before renewal |
| Payment failed | Update payment method | On failure |
| Payment still failed | Final warning | 3 days after first failure |

### Paywall Abandonment Sequence

| Email | Timing | Focus |
| --- | --- | --- |
| 1 | 1 hour | "You watched the intro — here's what's waiting" |
| 2 | 24 hours | "Most people fail because they don't have a system" |
| 3 | 3 days | "Last chance: 90-day guarantee means zero risk" |

### Admin Features

- **Email template management:** Edit subject, body, toggle active/inactive
- **Trigger configuration:** Set conditions
- **Email logs:** View sent emails per user

### Edge Cases

- **Unsubscribe:** Users can opt out of marketing emails (transactional always send)

---

### 2.6 Admin Panel

**Purpose:** Manage content, users, and email sequences.

### Features

- **Dashboard:** User count, active subscribers, MRR, conversion metrics
- **Content management:** Modules, lessons, assets (see 2.3)
- **User management:** View users, search, filter by status, view progress
- **Email management:** Templates, triggers, logs (see 2.5)
- **Access overrides:** Manually grant/revoke access to specific users

### Auth

- Admin-only route, protected by role check
- Single admin user (you) — no multi-admin for MVP

---

### 2.7 Analytics & Event Tracking

**Purpose:** Understand funnel performance and user behaviour.

### Must-Track Events

| Event | Why It Matters |
| --- | --- |
| `signup_started` | Top of funnel |
| `signup_completed` | Signup conversion |
| `onboarding_completed` | Activation step 1 |
| `video_1_started` | Engagement signal |
| `video_1_completed` | Activation complete — paywall trigger |
| `paywall_viewed` | Conversion funnel entry |
| `subscription_started` | Revenue event |
| `subscription_plan_selected` | Monthly vs annual split |
| `lesson_started` | Engagement depth |
| `lesson_completed` | Progress tracking |
| `module_completed` | Milestone tracking |
| `course_completed` | Full completion |
| `subscription_cancelled` | Churn signal |
| `subscription_renewed` | Retention signal |

### Leading Indicators

| Metric | Predicts |
| --- | --- |
| Video 1 completion rate | Paywall conversion |
| Lessons completed in Week 1 | M1 retention |
| Annual vs monthly split | Revenue predictability |

---

## 3. Phase 2 — Roadmap (NOT in current build)

*Captured for future reference. Will NOT be built now.*

| Feature | Description | Why Deferred |
| --- | --- | --- |
| **PreCursor agent integration** | Guided building via AI agents | Integrating pre-launch, scope TBD |
| **Community features** | Discussions, Q&A, peer interaction | Discord handles this for now |
| **Team/seat pricing** | Per-seat model for tech teams | Validate individual demand first |
| **Certificates/badges** | Downloadable PDF certificate, LinkedIn badge | Nice-to-have |
| **Bookmarking/notes** | Save lessons, take notes in-platform | Adds scope |
| **Cohort-based features** | Start dates, group progression | Only if demand emerges |
| **Multi-course expansion** | Additional courses | Single course first |

---

## 4. Global Requirements

### Authentication & Authorisation

- Auth provider: **NextAuth.js** (database sessions, Google OAuth + email)
- Roles: User, Admin
- Protected routes: All course content requires auth (except Video 1), admin routes require admin role

### Data & Privacy

- User data: Name, email, onboarding responses, progress, subscription status
- Payment data: Handled by Stripe (no card data stored)
- GDPR: Account deletion flow (manual for MVP)

### Performance & Scale

- Video delivery via Mux CDN
- Content cacheable (lessons rarely change)
- Target: Handle 1,000 concurrent users without degradation

### Tech Stack (Confirmed)

- Next.js 14 (App Router), React, TypeScript, Tailwind, shadcn/ui
- Prisma + PostgreSQL (Neon)
- **NextAuth.js** for authentication
- Stripe for payments
- Mux for video
- **Mailgun** for transactional email
- **Custom event tracking** (own database table)
- TipTap for rich text editing
- Vercel for deployment

---

## 5. User Flows Summary

### New User (Free → Paid)

Sign up → Guided onboarding → Land on dashboard → Watch Video 1 (founder intro) → Hit paywall → Subscribe (monthly or annual) → Unlock full course

### New User (Direct Paid)

Sign up → Guided onboarding → Watch Video 1 → Subscribe immediately → Full course access

### Returning User

Log in → Dashboard (resume where left off) → Continue lessons → Complete modules → Celebration moment → Finish course

### Paywall Abandonment

Complete Video 1 → See paywall → Leave without subscribing → Email 1 (1hr) → Email 2 (24hr) → Email 3 (3 days)

### Failed Payment

Payment fails → Soft lock (see structure, content locked) → Email notification → Banner prompts payment update → Update payment → Access restored

### Refund Request

User requests refund (within 90 days) → Manual processing → Stripe refund → Access revoked

### Admin

Log in → Admin dashboard → Manage content / View users / Configure emails / View analytics

---

## 6. Resolved Decisions

*Confirmed 24 Dec 2025:*

- [x]  **Auth provider:** NextAuth.js (database sessions)
- [x]  **Email provider:** Mailgun
- [x]  **Rich text editor:** TipTap
- [x]  **Analytics:** Custom event tracking (database table)
- [x]  **OAuth providers:** Google only (GitHub later if needed)

---

## 7. Out of Scope

*Explicitly NOT included in this build:*

- Native mobile apps (web-responsive only)
- Offline access
- Video downloads
- Multi-language / i18n
- Affiliate / referral program
- Live sessions / webinars
- Community / forum features (Discord handles this)
- Free tier beyond Video 1

---

**Next Step:** Technical Stack Decisions → Schema Design